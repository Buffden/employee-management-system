@startuml CI/CD Pipeline
' Updated to reflect GitHub Actions CI/CD with Docker Hub
skinparam linetype ortho
skinparam roundcorner 10

title Employee Management System - CI/CD Pipeline

node "Source Control" #LightBlue {
    [GitHub Repository] as GitHub
}

node "CI Pipeline (GitHub Actions)" #LightGreen {
    [Checkout Code] as Checkout
    [Backend Tests] as BackendTest
    [Frontend Tests] as FrontendTest
    [Docker Build Verification] as DockerBuild
    [Code Quality Checks] as Quality
}

node "CD Pipeline (GitHub Actions)" #LightYellow {
    [Build Docker Images] as BuildImages
    [Push to Docker Hub] as PushDocker
    [SSH to EC2] as SSH
    [Pull Images] as PullImages
    [Generate .env] as GenEnv
    [Deploy Containers] as Deploy
}

cloud "External Services" #LightCoral {
    [Docker Hub] as DockerHub
    [EC2 Server] as EC2
    [AWS RDS] as RDS
}

database "Test Database" as TestDB

GitHub --> Checkout : Trigger on PR/Push
Checkout --> BackendTest : Run Maven tests
Checkout --> FrontendTest : Run npm tests
BackendTest --> TestDB : Connect to test DB
BackendTest --> Quality : Code quality checks
FrontendTest --> Quality : Linting
Quality --> DockerBuild : Build verification

GitHub --> BuildImages : Merge to main
BuildImages --> PushDocker : Images built
PushDocker --> DockerHub : Push images
DockerHub --> SSH : Trigger deployment
SSH --> PullImages : Connect to EC2
PullImages --> DockerHub : Pull images
PullImages --> GenEnv : Generate .env.production
GenEnv --> Deploy : Start containers
Deploy --> EC2 : Running containers
Deploy --> RDS : Database connection

note right of BackendTest
  **CI Steps:**
  - Set up JDK 17
  - Run Maven tests
  - Build JAR
  - Code quality checks
end note

note right of FrontendTest
  **CI Steps:**
  - Set up Node.js 18
  - Install dependencies
  - Run linter
  - Run tests
  - Build application
end note

note right of BuildImages
  **CD Steps:**
  - Build backend image
  - Build gateway image
  - Tag as latest
  - Push to Docker Hub
end note

note right of Deploy
  **Deployment:**
  - Pull latest code
  - Pull images from Docker Hub
  - Generate .env from secrets
  - docker-compose up -d
  - Health checks
  - Verify running
end note

@enduml

