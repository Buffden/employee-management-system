@startuml Docker Architecture
' Workflow test - updated
skinparam linetype ortho
skinparam roundcorner 10

title Employee Management System - Docker Architecture

node "EC2 Instance" #LightBlue {
    node "Docker Network: ems-network" #LightYellow {
        component [Spring Boot API Container\nems-backend] as Backend
        component [Nginx Gateway Container\nems-gateway] as Gateway
        component [Certbot Container\nems-certbot] as Certbot
    }
}

cloud "External" #LightGreen {
    [User Browser] as User
    [Docker Hub] as DockerHub
    [AWS RDS] as RDS
}

User --> Gateway : HTTPS (Port 443)\nHTTP (Port 80)
Gateway --> Backend : HTTP (Internal)
Backend --> RDS : JDBC (SSL)

DockerHub --> Gateway : Pull image\n{username}/ems-gateway:latest
DockerHub --> Backend : Pull image\n{username}/ems-backend:latest

note right of Gateway
  **Container:** ems-gateway
  **Port:** 80:80
  **Purpose:** API Gateway, routing
  **Features:**
  - Routes /api/* to backend
  - Serves static frontend files
  - Health check endpoint
end note

note right of Backend
  **Container:** ems-backend
  **Port:** Internal only
  **Purpose:** REST API
  **Features:**
  - Employee CRUD
  - Department CRUD
  - Dashboard metrics
  - Health check: /api/departments
end note

note right of Certbot
  **Container:** ems-certbot
  **Image:** certbot/certbot:latest
  **Purpose:** SSL certificate management
  **Features:**
  - Auto-renew Let's Encrypt certs
  - Shares volumes with gateway
end note

note right of RDS
  **Database:** AWS RDS PostgreSQL
  **Connection:** SSL required
  **Managed:** AWS managed service
  **Backup:** Automated backups
end note

@enduml

