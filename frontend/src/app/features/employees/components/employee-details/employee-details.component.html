<div class="employee-details-container">
  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <p>Loading employee details...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="!loading && errorMessage" class="error-container">
    <h2>Error</h2>
    <p>{{ errorMessage }}</p>
    <button mat-raised-button color="primary" routerLink="/employees">
      Back to Employees
    </button>
  </div>

  <!-- Employee Details -->
  <div *ngIf="!loading && !errorMessage && employee">
  <!-- Breadcrumb Navigation -->
  <nav class="breadcrumb-nav">
    <a routerLink="/employees" class="breadcrumb-link">Employees</a>
    <span class="breadcrumb-separator">/</span>
    <span class="breadcrumb-current">{{ employee.firstName }} {{ employee.lastName }}</span>
  </nav>

  <!-- Main Content Area: Left Panel + Right Sidebar -->
  <div class="content-layout">
    <!-- Left Panel: Main Content -->
    <div class="left-panel">
      <!-- Title and Actions -->
      <div class="title-section">
        <h1 class="employee-title">{{ employee.firstName }} {{ employee.lastName }}</h1>
        <div class="action-buttons" *ngIf="canEditEmployee() || canDeleteEmployee()">
          <button mat-icon-button [matMenuTriggerFor]="actionsMenu" title="More actions">
            <mat-icon>more_vert</mat-icon>
          </button>
          <mat-menu #actionsMenu="matMenu">
            <button mat-menu-item (click)="onEditEmployee()" *ngIf="canEditEmployee()">
              <mat-icon>edit</mat-icon>
              <span>Edit</span>
            </button>
            <button mat-menu-item (click)="onDeleteEmployee()" *ngIf="canDeleteEmployee()">
              <mat-icon>delete</mat-icon>
              <span>Delete</span>
            </button>
          </mat-menu>
        </div>
      </div>

      <!-- Contact Information Section -->
      <div class="contact-section">
        <h3 class="section-title">Contact Information</h3>
        <div class="contact-content">
          <div class="contact-item" *ngIf="employee.email">
            <span class="contact-label">Email:</span>
            <span class="contact-value">{{ employee.email }}</span>
          </div>
          <div class="contact-item" *ngIf="employee.phone">
            <span class="contact-label">Phone:</span>
            <span class="contact-value">{{ employee.phone }}</span>
          </div>
          <div class="contact-item" *ngIf="employee.address">
            <span class="contact-label">Address:</span>
            <span class="contact-value">{{ employee.address }}</span>
          </div>
          <div class="contact-item" *ngIf="employee.workLocation">
            <span class="contact-label">Work Location:</span>
            <span class="contact-value">{{ employee.workLocation }}</span>
          </div>
        </div>
      </div>

      <!-- Professional Information Section -->
      <div class="professional-section">
        <h3 class="section-title">Professional Information</h3>
        <div class="professional-content">
          <div class="professional-item">
            <span class="professional-label">Designation:</span>
            <span class="professional-value">{{ employee.designation }}</span>
          </div>
          <div class="professional-item" *ngIf="employee.experienceYears !== null && employee.experienceYears !== undefined">
            <span class="professional-label">Experience:</span>
            <span class="professional-value">{{ employee.experienceYears }} year{{ employee.experienceYears !== 1 ? 's' : '' }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Sidebar: Metadata -->
    <div class="right-sidebar">
      <div class="sidebar-section">
        <h4 class="sidebar-title">Details</h4>
        
        <!-- Department -->
        <div class="sidebar-item">
          <span class="sidebar-label">Department</span>
          <div class="sidebar-value">
            <a *ngIf="department?.id" 
               [routerLink]="['/departments', department!.id]" 
               class="clickable-link">
              {{ department?.name || employee.departmentName || 'Not specified' }}
            </a>
            <span *ngIf="!department?.id">{{ employee.departmentName || 'Not specified' }}</span>
          </div>
        </div>

        <!-- Location -->
        <div class="sidebar-item">
          <span class="sidebar-label">Location</span>
          <div class="sidebar-value">
            <a *ngIf="location?.id" 
               [routerLink]="['/locations', location!.id]" 
               class="clickable-link">
              {{ location?.name || employee.locationName || 'Not specified' }}
            </a>
            <span *ngIf="!location?.id">{{ employee.locationName || 'Not specified' }}</span>
          </div>
        </div>

        <!-- Manager -->
        <div class="sidebar-item" *ngIf="employee.managerId || employee.managerName">
          <span class="sidebar-label">Manager</span>
          <div class="sidebar-value">
            <a *ngIf="manager?.id" 
               [routerLink]="['/employees', manager!.id]" 
               class="clickable-link">
              {{ manager?.firstName }} {{ manager?.lastName }}
            </a>
            <span *ngIf="!manager?.id">{{ employee.managerName || 'Not assigned' }}</span>
          </div>
        </div>

        <!-- Salary -->
        <div class="sidebar-item">
          <span class="sidebar-label">Salary</span>
          <div class="sidebar-value">{{ formatCurrency(employee.salary) }}</div>
        </div>

        <!-- Joining Date -->
        <div class="sidebar-item">
          <span class="sidebar-label">Joining Date</span>
          <div class="sidebar-value">{{ formatDate(employee.joiningDate) }}</div>
        </div>

        <!-- Performance Rating -->
        <div class="sidebar-item" *ngIf="employee.performanceRating !== null && employee.performanceRating !== undefined">
          <span class="sidebar-label">Performance Rating</span>
          <div class="sidebar-value">{{ employee.performanceRating.toFixed(1) }}</div>
        </div>
      </div>
    </div>
  </div>
</div>

